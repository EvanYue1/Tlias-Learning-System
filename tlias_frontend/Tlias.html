<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tlias System</title>
    <style>
        /* Reset and global styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            min-height: 100vh;
        }

        /* Header navigation styling */
        .header-nav {
            background-color: #1c258e;
            color: white;
            padding: 0 5%;
            height: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .system-title {
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            color: white;
        }

        .logout-link {
            text-decoration: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            transition: all 0.3s ease;
            background-color: rgba(255,255,255,0.1);
        }

        .logout-link:hover {
            background-color: rgba(255,255,255,0.2);
        }

        /* Main content wrapper */
        .page-wrapper {
            padding-top: 60px; /* Same as header height */
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
            display: flex;
            flex-direction: column;
        }

        /* Main content area */
        .main-content {
            /* max-width: 1200px; */
            margin: 0 auto;
            padding: 2rem 20px;
        }

        /* Search container */
        .search-container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            padding: 1.5rem;
            margin-top: 1rem;

        }

        /* Form styling */
        .error-message {
            color: #e74c3c; /* Red color */
            font-size: 0.85rem;
            margin-top: 4px;
            display: block; /* Ensure it appears below input */
        }

        .search-form {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .form-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .form-group label {
            font-weight: 500;
            color: #2c3e50;
            font-size: 0.95rem;
        }
        
        .error-highlight {
            border: solid #e74c3c !important /*important is used to override the default border and improve the specificity of the style*/
        }

        .form-group input,
        .form-group select {
            padding: 0.625rem 1rem;
            border: 1.5px solid #e1e1e1;
            border-radius: 6px;
            width: 180px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
        }

        .form-group input:hover,
        .form-group select:hover {
            border-color: #3498db;
            background-color: white;
        }

        

        /* Style for input fields when they receive focus (clicked or tabbed into) */
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.1);
            background-color: white;
        }

        /* Button styling */
        .btn-group {
            display: flex;
            gap: 0.75rem;
            margin-left: auto;
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .btn-search {
            background-color: #1a237e;
            color: white;
        }

        .btn-search:hover {
            background-color: #283593;
            transform: translateY(-1px);
        }

        .btn-clear {
            background-color: #f8f9fa;
            border: 1.5px solid #e1e1e1;
            color: #666;
        }

        .btn-clear:hover {
            background-color: #e9ecef;
            border-color: #dde0e3;
        }

        /* Data table container */
        .data-container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            padding: 1.5rem;
            margin-top: 2rem;
        }

        /* Table styling */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .data-table th {
            background-color: #f8f9fa;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 2px solid #e9ecef;
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
            vertical-align: middle; /* Center the content vertically */
        }

        .highlighted-row {
            background-color: #f0f0f0;
        }

        /* Add a transition effect for the background color */
        tr {
            transition: background-color 0.4s ease;
        }

        /* Profile image styling */
        .profile-image {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover; /* Ensure the image covers the area without distortion */
        }

        /* Operation buttons */
        .operation-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn-edit {
            background-color: #3498db;
            color: white;
            padding: 0.5rem 1rem;
        }

        .btn-edit:hover {
            background-color: #2980b9;
        }

        .btn-delete {
            background-color: #e74c3c;
            color: white;
            padding: 0.5rem 1rem;
        }

        .btn-delete:hover {
            background-color: #c0392b;
        }

        /* Footer styling */
        .footer {
            background-color: #1a237e;
            color: rgba(255, 255, 255, 0.8);
            padding: 2rem 0;
            text-align: center;
            margin-top: auto; /* Ensure the footer stays at the bottom */
        }

        .company-name {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: hwb(0 91% 9%);
        }

        .copyright {
            font-size: 0.9rem;
        }

        /* Style for select placeholder option */
        .form-group select option:first-child {
            color: #757575;  /* Light grey color matching input placeholder */
        }

        /* Style for select when showing placeholder */
        .form-group select:required:invalid {
            color: #757575;  /* Light grey color matching input placeholder */
        }

        /* Style for select when option is selected */
        .form-group select:required:valid {
            color: #2c3e50;  /* Dark color for selected value */
        }
    </style>
</head>
<body>
    <!-- Header Navigation -->
    <header class="header-nav">
        <div class="system-title">Tlias Intelligent Learning System</div>
        <a href="#" class="logout-link">Log Out</a>
    </header>

    <!-- Page Wrapper -->
    <div id="page-wrapper" class="page-wrapper">
        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Search Container -->
            <div class="search-container">
                <form novalidate class="search-form" action="/save" method="post">
                    <!-- Name input field -->
                    <div class="form-group">
                        <label for="name">Name:</label>
                        <input :class="problemSign[0] ? '' : 'error-highlight' " v-model="formData.name" type="text" id="name" name="name" placeholder="Enter name">
                        <span v-if="!problemSign[0]" class="error-message">Name is required</span>
                    </div>

                    <!-- Gender select field -->
                    <div class="form-group">
                        <label for="gender">Gender:</label>
                        <select v-model="formData.gender" id="gender" name="gender" required>
                            <option value="" disabled selected>Select gender</option>
                            <option value="female">Female</option>
                            <option value="male">Male</option>
                        </select>
                    </div>

                    <!-- Work position select field -->
                    <div class="form-group">
                        <label for="work">Work:</label>
                        <select v-model="formData.work" id="work" name="work" required>
                            <option value="" disabled selected>Select position</option>
                            <option value="header_teacher">Header Teacher</option>
                            <option value="lecturer">Lecturer</option>
                            <option value="director">Director of Teaching</option>
                            <option value="researcher">Researcher</option>
                            <option value="consultant">Consultant</option>
                        </select>
                    </div>

                    <!-- Action buttons -->
                    <div class="btn-group">
                        <button type="submit" class="btn btn-search" @click.prevent="searchEmployee">Search</button>
                        <button type="reset" class="btn btn-clear" @click="clearForm">Clear</button>
                    </div>
                </form>
            </div>
            <!-- Data Container -->
            <div class="data-container">
                <table class="data-table" v-if="empList.length > 0">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Gender</th>
                            <th>Profile</th>
                            <th>Role</th>
                            <th>Start Date</th>
                            <th>Last Operation</th>
                            <th>Operation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Harry Potter -->
                        <tr v-for="(emp, index) in empList" :key="emp.name" :class="getRowClass(index)" @mouseleave="hoveredRow = null" @mouseover="hoveredRow = index">
                            <td>{{ emp.id }}</td>
                            <td>{{ emp.username }}</td>
                            <td>{{emp.gender}}</td>
                            <td><img :src="emp.image" alt="Harry Potter" class="profile-image"></td>
                            <td>{{ emp.deptName }}</td>
                            <td>{{ emp.createTime }}</td>
                            <td>{{ emp.updateTime }}</td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="btn btn-edit">Edit</button>
                                    <button class="btn btn-delete">Delete</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>
        <!-- Footer Section -->
        <footer class="footer">
            <div class="company-name">Tlias Technology Solutions Co., Ltd.</div>
            <div class="copyright">Copyright © 2024 Tlias. All Rights Reserved.</div>
        </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module">
        import { createApp, ref } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
        createApp({
            data() {
                return {
                    hoveredRow: null,
                    isMouseOver: false,
                    problemSign: [true, true, true],
                    formData: {
                        name: '',
                        gender: '',
                        work: '',
                    },
                    empList: []
                }
            },
            methods: {
                // check if the form is valid
                checkFormValidity() {
                    let flag = true
                    if (this.formData.name === '') {
                        this.problemSign[0] = false
                        flag = false
                    } else {
                        this.problemSign[0] = true
                    }
                    if (this.formData.gender === '') {
                        this.problemSign[1] = false
                        flag = false
                    } else {
                        this.problemSign[1] = true
                    }
                    if (this.formData.work === '') {
                        this.problemSign[2] = false
                        flag = false
                    } else {
                        this.problemSign[2] = true
                    }
                    if (flag) {
                        return true
                    } else {
                        return false
                    }
                },
                getRowClass(index) {
                    return this.hoveredRow === index ? 'highlighted-row' : '';
                },
                clearForm() {
                    this.formData.name = '';
                    this.formData.gender = '';
                    this.formData.work = '';
                },
                async searchEmployee() {
                    if (!this.checkFormValidity()) {
                        return
                    }
                    res = await axios.post('https://tlias/employee/search', {
                        name: this.formData.name,
                        gender: this.formData.gender,
                        work: this.formData.work
                    })
                },
                async getEmployeeList() {
                    const res = await axios.get('http://localhost:8080/emps')
                    const resOperated = res.data.data.rows.map(
                        (emp) => {
                            emp.createTime = new Date(emp.createTime).getFullYear() + '-' + 
                            (new Date(emp.createTime).getMonth() + 1) + '-' +
                            new Date(emp.createTime).getDate() + ' ' +
                            new Date(emp.createTime).getHours() + ':' +
                            new Date(emp.createTime).getMinutes() + ':' +
                            new Date(emp.createTime).getSeconds()
                            emp.updateTime = new Date(emp.updateTime).getFullYear() + '-' + 
                            (new Date(emp.updateTime).getMonth() + 1) + '-' +
                            new Date(emp.updateTime).getDate() + ' ' +
                            new Date(emp.updateTime).getHours() + ':' +
                            new Date(emp.updateTime).getMinutes() + ':' +
                            new Date(emp.updateTime).getSeconds()
                            return emp
                        }
                    )
                    this.empList = resOperated
                },   
            },
            mounted() {
            },
            created() {
                this.getEmployeeList();
            }
        }).mount('#page-wrapper')
    </script>
</body>
</html>